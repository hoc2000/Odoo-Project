<odoo>
    <data>
        <!-- explicit list view definition -->
        <!--        tree view-->
        <record model="ir.ui.view" id="ansv_project_list">
            <field name="name">ANSV Project list</field>
            <field name="model">project.ansv</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="project_name"/>
                    <field name="color" widget="color_picker"/>
                </tree>
            </field>
        </record>
        <!--        kanban view-->
        <record id="ansv_project_view_kanban" model="ir.ui.view">
            <field name="name">ansv.project.view.kanban</field>
            <field name="model">project.ansv</field>
            <field name="arch" type="xml">
                <kanban default_group_by="stage_id"
                        class="o_kanban_dashboard o_project_ansv_kanban oe_kanban_card" records_draggable="1"
                        type="object">
                    <field name="project_name"/>
                    <field name="manager_id"/>
                    <field name="partner_ids"/>
                    <field name="date_start"/>
                    <field name="date_end"/>
                    <field name="color"/>
                    <field name="tag_ids"/>
                    <field name="product_count"/>
                    <field name="task_count"/>
                    <field name="ticket_count"/>
                    <field name="label_tasks"/>
                    <field name="sequence" widget="handle"/>
                    <field name="last_update_status"/>
                    <field name="last_update_color"/>
                    <field name="last_update_progress"/>
                    <progressbar field="last_update_status"
                                 colors="{&quot;on_track&quot;: &quot;success&quot;, &quot;at_risk&quot;: &quot;warning&quot;, &quot;off_track&quot;: &quot;danger&quot;, &quot;on_hold&quot;: &quot;info&quot;}"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_color_#{kanban_getcolor(record.color.raw_value)} oe_kanban_global_click">
                                <!-- main content-->
                                <div class="kanban_main" style="max-width: 350px">
                                    <div class="o_kanban_card_content mw-100" style="margin-left:12px">
                                        <div class="o_kanban_primary_left">
                                            <div class="o_primary">
                                                <span class="o_text_overflow o_kanban_record_title"
                                                      t-att-title="record.project_name.raw_value">
                                                    <t t-esc="record.project_name.raw_value"/>
                                                </span>
                                                <div class="d-flex text-muted pb-2">
                                                    <field name="manager_id" widget="many2one_avatar_user"
                                                           t-if="record.manager_id.raw_value"/>
                                                    <t t-esc="record.manager_id.value"/>
                                                </div>
                                                <!-- Nếu có partner-->
                                                <span class="text-muted"
                                                      t-if="record.partner_ids.value">
                                                    <span class="fa fa-user me-2" aria-label="Partner" title="Partner"/>
                                                    <t t-esc="record.partner_ids.value"/>
                                                </span>
                                                <!-- Nếu có date-->
                                                <div t-if="record.date_end.raw_value or record.date_start.raw_value"
                                                     class="text-muted o_row">
                                                    <span class="fa fa-clock-o me-2" title="Dates"/>
                                                    <field name="date_start"/>
                                                    <i t-if="record.date_end.raw_value and record.date_start.raw_value"
                                                       class="fa fa-long-arrow-right mx-2 oe_read_only"
                                                       aria-label="Arrow icon"
                                                       title="Arrow"/>
                                                    <field name="date_end"/>
                                                </div>
                                                <!-- Thành phần tags-->
                                                <field name="tag_ids" widget="many2many_tags"
                                                       options="{'color_field': 'color'}"/>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Edit Menu -->
                                    <div class="container o_kanban_card_manage_pane dropdown-menu" role="menu"
                                         groups="base.group_user">
                                        <div class="row">
                                            <div class="col-6 o_kanban_card_manage_section o_kanban_manage_view">
                                                <div role="menuitem" class="o_kanban_card_manage_title">
                                                    <span>View</span>
                                                </div>
                                                <div role="menuitem">
                                                    <a name="action_view_tasks" type="object">Tasks</a>
                                                </div>
                                                <div role="menuitem">
                                                    <a name="action_view_products" type="object">Products</a>
                                                </div>
                                                <div role="menuitem">
                                                    <a name="action_view_updates" type="object">Project Updates</a>
                                                </div>
                                            </div>
                                            <div class="col-6 o_kanban_card_manage_section o_kanban_manage_reporting">
                                                <div role="menuitem" class="o_kanban_card_manage_title">
                                                    <span>Reporting</span>
                                                </div>
                                                <div role="menuitem">
                                                    <a name="" type="object">Tasks Analysis
                                                    </a>
                                                </div>
                                                <div role="menuitem" name="project_burndown_menu">
                                                    <a name="" type="object">
                                                        Burndown Chart
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="o_kanban_card_manage_settings row">
                                            <div role="menuitem" aria-haspopup="true" class="col-6">
                                                <ul class="oe_kanban_colorpicker" data-field="color" role="popup"/>
                                            </div>
                                            <div role="menuitem" class="col-6">
                                                <a class="dropdown-item" role="menuitem" name="1217" type="action">Share
                                                </a>
                                                <a class="dropdown-item" role="menuitem" type="edit">Project Detail</a>
                                            </div>
                                        </div>
                                    </div>
                                    <a class="o_kanban_manage_toggle_button o_dropdown_kanban" href="#"
                                       groups="base.group_user">
                                        <i class="fa fa-bars" role="img" aria-label="Manage" title="Manage"/>
                                    </a>
                                    <span>
                                        <field name="is_favorite" widget="boolean_favorite" nolabel="1" force_save="1"/>
                                    </span>
                                </div>
                                <!-- Progress-bar kanban -->
                                <div class="progress">
                                    <div id="project_progress" class="progress-bar bg-info text-left" role="progressbar" t-attf-style="width:#{record.last_update_progress.value}%;"
                                         t-att-aria-valuenow="record.last_update_progress.value"
                                         aria-valuemin="0" aria-valuemax="100" name="10">
                                        <field name="last_update_progress_percentage"
                                               widget="percentage"/>
                                    </div>
                                </div>
                                <!--footer kanban-->
                                <div class="o_kanban_record_bottom mt-3">
                                    <!-- left side-->
                                    <div class="oe_kanban_bottom_left">
                                        <div class="d-flex value-project">
                                            <div class="project_comp border rounded d-flex align-items-baseline p-2 mb-2 me-1 btn btn-outline-primary"
                                                 attrs="{'invisible':[('product_count','=',0)]}">
                                                <a class="o_project_kanban_box" name="action_view_products"
                                                   type="object">
                                                    <div>
                                                        <span class="o_value">
                                                            <t t-esc="record.product_count.value"/>
                                                        </span>
                                                        <span class="o_label ms-1">
                                                            Products
                                                        </span>
                                                    </div>
                                                </a>
                                            </div>

                                            <div class="project_comp border rounded d-flex align-items-baseline p-2 mb-2 me-1 btn btn-outline-primary"
                                                 attrs="{'invisible':[('ticket_count','=',0)]}">
                                                <a class="o_project_kanban_box" name="action_view_ticket"
                                                   type="object">
                                                    <div>
                                                        <span class="o_value">
                                                            <t t-esc="record.ticket_count.value"/>
                                                        </span>
                                                        <span class="o_label ms-1">
                                                            Tickets
                                                        </span>
                                                    </div>
                                                </a>
                                            </div>

                                            <div class="project_comp border rounded d-flex align-items-baseline p-2 mb-2 me-1 btn btn-outline-primary">
                                                <a class="o_project_kanban_box" name="action_view_tasks"
                                                   type="object">
                                                    <div>
                                                        <span class="o_value">
                                                            <t t-esc="record.task_count.value"/>
                                                        </span>
                                                        <span class="o_label ms-1">
                                                            Tasks
                                                        </span>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                        <field name="activity_ids" widget="kanban_activity" class="mb-2"/>
                                    </div>
                                    <!-- right side-->
                                    <!-- project_state_selection-->
                                    <div class="oe_kanban_bottom_right">
                                        <span class="d-flex">
                                            <field t-if="widget.editable"
                                                   name="last_update_status" widget="project_state_selection"
                                                   options="{'color_field': 'last_update_color'}"/>
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        <!--        form view-->
        <record id="ansv_project_view_form" model="ir.ui.view">
            <field name="name">ANSV Project Form</field>
            <field name="model">project.ansv</field>
            <field name="arch" type="xml">
                <form string="_form">

                    <header>
                        <field name="stage_id" widget="statusbar" context="{'order_display': 'sequence desc' }"
                               options="{'clickable': '1','autosave': False}"/>
                        <button name="create_cashflow_by_button" class="btn" type="object" string="Add Cashflow"
                                invisible="1"/>
                    </header>
                    <sheet string="Project">
                        <div class="oe_button_box" name="button_box">
                            <button name="action_view_ticket" type="object"
                                    attrs="{'invisible': [('ticket_count', '=', 0)]}"
                                    class="oe_stat_button" icon="fa-life-ring"
                                    string="Tickets">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_info o_stat_value">
                                        <field name="ticket_count"/>
                                    </span>
                                    <span class="o_stat_text">Tickets</span>
                                </div>
                            </button>
                            <button class="oe_stat_button"
                                    name="action_view_tasks" type="object"
                                    icon="fa-tasks"
                                    attrs="{'invisible': [('task_count', '=', 0)]}"
                                    string="Tasks">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_info o_stat_value">
                                        <field name="task_count"/>
                                    </span>
                                    <span class="o_stat_text">Tasks</span>
                                </div>

                            </button>
                            <button class="oe_stat_button"
                                    name="action_view_tasks" type="object"
                                    icon="fa-archive"
                                    attrs="{'invisible': [('product_count', '=', 0)]}"
                                    string="Products">
                                <div class="o_field_widget o_stat_info">
                                    <span class="o_stat_info o_stat_value">
                                        <field name="product_count"/>
                                    </span>
                                    <span class="o_stat_text">Products</span>
                                </div>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h1 class="d-flex flex-row">
                                <field name="is_favorite" nolabel="1" widget="boolean_favorite" class="me-2"/>
                                <field name="project_name" class="o_text_overflow" placeholder="e.g. Project example"/>
                            </h1>
                        </div>
                        <group>
                            <field name="active" invisible="1"/>
                            <group>
                                <field name="team_id" string="Team"/>
                            </group>
                            <group>
                                <field name="manager_id" string="Project Manager" widget="many2one_avatar_user"
                                       attrs="{'readonly':[('active','=',False)]}" domain="[('share', '=', False)]"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="General Information">
                                <group>
                                    <group>
                                        <field name="label_tasks" string="Name of the tasks" invisible="1"/>
                                        <field name="priority" string="Priority" widget="priority"
                                               options="{'autosave': False}"/>
                                        <field name="partner_ids"/>
                                        <field name="department"/>
                                        <field name="tag_ids" widget="many2many_tags"
                                               options="{'color_field': 'color'}"/>
                                        <field name="category_id"/>
                                        <field name="color" widget="color_picker"/>
                                    </group>
                                    <group>
                                        <field name="acc_code"/>
                                        <field name="con_code"/>
                                        <label for="date_start" string="Planned Date"/>
                                        <div name="dates" class="o_row">
                                            <field name="date_start" widget="daterange"
                                                   options="{'related_end_date': 'date_end'}"/>
                                            <i class="fa fa-long-arrow-right mx-2 oe_edit_only" aria-label="Arrow icon"
                                               title="Arrow"/>
                                            <i class="fa fa-long-arrow-right mx-2 oe_read_only" aria-label="Arrow icon"
                                               title="Arrow"
                                               attrs="{'invisible': [('date_start', '=', False), ('date_end', '=', False)]}"/>
                                            <field name="date_end" widget="daterange"
                                                   options="{'related_start_date': 'date_start'}"/>
                                        </div>
                                    </group>

                                </group>
                                <group string="Properties">
                                    <field name="project_prop_id" string="Extend fields Define"/>
                                </group>
                                <field name="project_properties" nolabel="1" columns="2"/>
                                <notebook>
                                    <page name="description" string="Description">
                                        <field name="description_project" placeholder="enter your description here"/>
                                    </page>
                                </notebook>
                            </page>
                            <page name="product" string="Product">
                                <field name="product_lines_id" widget="many2many"
                                       domain="[('project_id', '=', False)]">
                                    <!--    khai báo tree trong page-->
                                    <!--                                    <tree edit="0">-->
                                    <!--                                        <field name="product_name"-->
                                    <!--                                               options="{'no_create': True, 'no_create_edit':True}"/>-->
                                    <!--                                        <field name="product_ref"/>-->
                                    <!--                                        <field name="count_component"/>-->
                                    <!--                                    </tree>-->
                                    <kanban>
                                        <field name="product_name"/>
                                        <field name="image"/>
                                        <field name="product_ref"/>
                                        <field name="count_component"/>
                                        <templates>
                                            <t t-name="kanban-box">
                                                <div class="oe_kanban_card border oe_kanban_global_click">
                                                    <div class="o_kanban_image me-1">
                                                        <img t-att-src="kanban_image('product.ansv', 'image', record.id.raw_value)"
                                                             alt="Product" class="o_image_64_contain"/>
                                                    </div>
                                                    <div class="oe_kanban_details">
                                                        <div class="o_kanban_record_top mb-0">
                                                            <div class="o_kanban_record_headings">
                                                                <b class="o_kanban_record_title"
                                                                   style="font-size: 15px;">
                                                                    <field name="product_name"/>
                                                                </b>
                                                            </div>
                                                        </div>
                                                        <div class="text-muted">
                                                            <field name="product_ref"
                                                                   attrs="{'invisible': [('product_ref', '=', 'False')]}"/>
                                                        </div>
                                                        <div attrs="{'invisible': [('count_component', '&lt;', '1')]}">
                                                            <strong>
                                                                <field name="count_component"/>
                                                                Components
                                                            </strong>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                    <!--                                        form pop up-->
                                </field>
                            </page>
                            <page string="Cashflow">
                                <field name="currency_id" invisible="1"/>
                                <field name="dac_info_id" invisible="1"/>
                                <field name="pac_info_id" invisible="1"/>
                                <field name="fac_info_id" invisible="1"/>
                                <field name="dac_time_notice" invisible="1"/>
                                <field name="dac_duration" invisible="1"/>
                                <field name="pac_duration" invisible="1"/>
                                <field name="fac_duration" invisible="1"/>

                                <templates>
                                    <table class="table table-striped tg mb-0" style="table-layout: fixed; width: 100%">
                                        <thead>
                                            <tr style="background-color:#4b4c59; color:#ffffff;">
                                                <td class="tg-mcqj"/>
                                                <td class="tg-mcqj" style="font-weight: bolder;">Cash<br/>(VND):
                                                </td>
                                                <td class="tg-mcqj" style="font-weight: bolder;">Contract<br/>(D/M/Y)
                                                </td>
                                                <td class="tg-mcqj" style="font-weight: bolder;">Target<br/>(D/M/Y)
                                                </td>
                                                <td class="tg-mcqj" style="font-weight: bolder;">Reality<br/>(D/M/Y)
                                                </td>
                                                <td class="tg-mcqj" style="font-weight: bolder;">Time<br/>Notice
                                                </td>
                                                <td class="tg-mcqj" style="font-weight: bolder;">Noted
                                                    <br/>
                                                </td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr class="dac-info">
                                                <td class="tg-mcqj d-flex" style="font-weight: bolder;">
                                                    <field name="dac_info_id" style="width:80px" widget="selection"/>
                                                    <a name="dac_modal_tree_view" type="object"
                                                       class="o_project_kanban_box">
                                                        <i class="fa fa-list" title="List Icon" aria-hidden="true"/>
                                                    </a>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="dac_cash"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="dac_contact_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="dac_target_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="dac_reality_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="time-notice">
                                                    <field name="dac_time_notice" class="text-danger"
                                                           attrs="{'invisible': ['|',('dac_duration', '&gt;', 0),('dac_duration', '=', 0)]}"
                                                    />
                                                    <field name="dac_time_notice" class="text-success"
                                                           attrs="{'invisible': [('dac_duration', '&lt;', 0)]}"
                                                    />
                                                </td>
                                                <td class="tg-mcqj">@@</td>

                                            </tr>
                                            <tr class="pac-info">
                                                <td class="tg-mcqj d-flex" style="font-weight: bolder;">
                                                    <field name="pac_info_id" style="width:80px" widget="selection"/>
                                                    <a name="pac_modal_tree_view" type="object"
                                                       class="o_project_kanban_box">
                                                        <i class="fa fa-list" title="List Icon" aria-hidden="true"/>
                                                    </a>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="pac_cash"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="pac_contact_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="pac_target_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="pac_reality_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="time-notice">
                                                    <field name="pac_time_notice" class="text-danger"
                                                           attrs="{'invisible': ['|',('pac_duration', '&gt;', 0),('pac_duration', '=', 0)]}"
                                                    />
                                                    <field name="pac_time_notice" class="text-success"
                                                           attrs="{'invisible': [('pac_duration', '&lt;', 0)]}"
                                                    />
                                                </td>
                                                <td class="tg-mcqj">@@</td>

                                            </tr>

                                            <tr class="fac-info">
                                                <td class="tg-mcqj d-flex" style="font-weight: bolder;">
                                                    <field name="fac_info_id" style="width:80px" widget="selection"/>
                                                    <a name="fac_modal_tree_view('DAC')" type="object"
                                                       class="o_project_kanban_box">
                                                        <i class="fa fa-list" title="List Icon" aria-hidden="true"/>
                                                    </a>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="fac_cash"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="fac_contact_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="fac_target_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="fac_reality_date" placeholder="Enter Date"/>
                                                </td>
                                                <td class="time-notice">
                                                    <field name="fac_time_notice" class="text-danger"
                                                           attrs="{'invisible': ['|',('fac_duration', '&gt;', 0),('fac_duration', '=', 0)]}"
                                                    />
                                                    <field name="fac_time_notice" class="text-success"
                                                           attrs="{'invisible': [('fac_duration', '&lt;', 0)]}"
                                                    />
                                                </td>
                                                <td class="tg-mcqj">@@</td>
                                            </tr>
                                            <tr class="summary">
                                                <td class="tg-mcqj" style="font-weight: bolder;">
                                                    <span>Target Summary</span>
                                                </td>
                                                <td class="tg-mcqj">
                                                    <field name="summary_target"/>
                                                </td>
                                                <td class="tg-mcqj bg-secondary"/>
                                                <td class="tg-mcqj bg-secondary"/>
                                                <td class="tg-mcqj bg-secondary"/>
                                                <td class="tg-mcqj bg-secondary"/>
                                                <td class="tg-mcqj bg-secondary"/>
                                            </tr>
                                        </tbody>
                                    </table>
                                </templates>
                            </page>
                            <page name="members" string="Members" attrs="{'invisible': [('team_id', '=', False)]}">
                                <field name="member_ids" widget="many2many_avatar_user"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"
                               help="Follow this project to automatically track the events associated to tasks and issues of this project."
                               groups="base.group_user"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>


        <!--        Search_view-->
        <record id="project_ansv_search" model="ir.ui.view">
            <field name="name">project.ansv.search</field>
            <field name="model">project.ansv</field>
            <field name="arch" type="xml">
                <search>
                    <field name="project_name" string="Project name"
                           filter_domain="['|',('name','ilike',self),('ref','ilike',self)]"/>
                    <field name="partner_ids" string="Partner"/>
                    <field name="manager_id" string="Manager"/>
                    <field name="stage_id" string="Stage"/>
                    <!-- filter-->
                    <filter name="filter_archived" string="Archive" domain="[('active','=',False)]"/>
                    <separator/>
                    <filter name="manage_pj_filter" string="My Manage Project" domain="[('manager_id','=',uid)]"/>
                    <filter name="member_pj_filter" string="My Project Join" domain="[('member_ids','=',uid)]"/>
                    <separator/>
                    <filter name="filter_new_state" string="New Status" domain="[('stage_id','=','New')]"/>
                    <separator/>
                    <filter name="filter_no_manager" string="No Manager" domain="[('manager_id','=',False)]"/>
                    <separator/>
                    <filter name="do_project" string="DO Project" domain="[('department','=','DO')]"/>
                    <filter name="tasc_project" string="TASC Project" domain="[('department','=','TASC')]"/>

                    <group expand="0" string="Group by">
                        <filter string="Departments" name="group_by_department" context="{'group_by':'department'}"/>
                        <filter string="Stage" name="group_by_stage" context="{'group_by':'stage_id'}"/>
                        <filter string="Team" name="group_by_team" context="{'group_by':'team_id'}"/>
                        <filter string="Priority" name="group_by_priority" context="{'group_by':'partner_ids'}"/>
                        <filter string="Date Received" name="group_by_created_date"
                                context="{'group_by': 'create_date'}"/>
                    </group>
                </search>
            </field>
        </record>


        <!-- actions opening views on models -->

        <record model="ir.actions.act_window" id="ansv__project.action_window">
            <field name="name">ANSV Project</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">project.ansv</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="view_ids" eval="[(5, 0, 0),
                       (0, 0, {'view_mode': 'kanban', 'view_id': ref('ansv__project.ansv_project_view_kanban')}),
                       (0, 0, {'view_mode': 'form', 'view_id': ref('ansv__project.ansv_project_view_form')})]"/>
            <field name="domain">['|',('member_ids', '=', uid),('manager_id','=',uid)]</field>
        </record>

        <!-- Top menu item -->

        <menuitem name="ANSV Project"
                  id="ansv__project.menu_root"
                  web_icon="ansv__project,static/description/icon.png"
                  sequence="0"/>

        <!-- menu categories -->

        <menuitem name="Project"
                  id="ansv__project.menu_1"
                  parent="ansv__project.menu_root"
                  action="ansv__project.action_window"
                  sequence="0"/>
        <!-- actions -->
        <!--
            <menuitem name="List" id="ansv__project.menu_1_list" parent="ansv__project.menu_1"
                      action="ansv__project.action_window"/>
            <menuitem name="Server to list" id="ansv__project" parent="ansv__project.menu_2"
                      action="ansv__project.action_server"/>
        -->
    </data>
</odoo>